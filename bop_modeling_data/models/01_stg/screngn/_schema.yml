models:
  - name: stg__screngn__xcd_bil_account
    description: "Staging model for billing account information from the 'screngn' source. It renames and casts columns from `raw__screngn__xcd_bil_account`."
    columns:
      - name: bil_account_id
        description: 'Billing account identifier, likely from `raw__screngn__xcd_bil_account.bil_account_id`.'
      - name: bil_account_id_hash
        description: "Hashed billing account identifier, likely from `raw__screngn__xcd_bil_account.bil_account_id_hash`. See {{ doc('bil_account_id_hash') }}."
        data_tests:
          - not_null

  - name: stg__screngn__xcd_bil_act_summary
    description: "Staging model for billing account summary from the 'screngn' source. Derived from `raw__screngn__xcd_bil_act_summary`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
      - name: bil_acy_dt
        data_tests:
          - not_null # Core date field
      - name: bil_acy_amt
        data_tests:
          - not_null # Monetary amount

  - name: stg__screngn__xcd_bil_cash_dsp
    description: "Staging model for billing cash disbursements from the 'screngn' source. Derived from `raw__screngn__xcd_bil_cash_dsp`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
      - name: XCD_POLICY_ID # Used to derive billing_policy_key
        data_tests:
          - not_null
      - name: POL_EFFECTIVE_DT
        data_tests:
          - not_null # Core date field

  - name: stg__screngn__xcd_bil_cash_receipt
    description: "Staging model for billing cash receipts from the 'screngn' source. Derived from `raw__screngn__xcd_bil_cash_receipt`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
      - name: bil_cash_rec_dt
        data_tests:
          - not_null # Core date field
      - name: bil_cash_rec_amt
        data_tests:
          - not_null # Monetary amount

  - name: stg__screngn__xcd_bil_des_reason
    description: "Staging model for billing designation reasons from the 'screngn' source. Derived from `raw__screngn__xcd_bil_des_reason`."

  - name: stg__screngn__xcd_bil_ist_schedule
    description: "Staging model for billing installment schedules from the 'screngn' source. Derived from `raw__screngn__xcd_bil_ist_schedule`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
      - name: bil_ist_eff_dt
        data_tests:
          - not_null # Core date field

  - name: stg__screngn__xcd_bil_pol_proc_req
    description: "Staging model for billing policy processing requests from the 'screngn' source. Derived from `raw__screngn__xcd_bil_pol_proc_req`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null

  - name: stg__screngn__xcd_bil_policy_trm
    description: "Staging model for billing policy terms from the 'screngn' source. Derived from `raw__screngn__xcd_bil_policy_trm`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
      - name: XCD_POLICY_ID
        data_tests:
          - not_null
      - name: POL_EFFECTIVE_DT
        data_tests:
          - not_null # Core date field
      - name: BPT_STATUS_EFF_DT
        data_tests:
          - not_null # Core date field

  - name: stg__screngn__xcd_bil_policy
    description: "Staging model for billing policies from the 'screngn' source. Derived from `raw__screngn__xcd_bil_policy`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
      - name: XCD_POLICY_ID
        data_tests:
          - not_null
      - name: pol_eff_dt # Assuming this is policy effective date
        data_tests:
          - not_null # Core date field
