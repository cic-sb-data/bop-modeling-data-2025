models:
  - name: stg__screngn__xcd_bil_account
    description: "Staging model for billing account information from the 'screngn' source. It renames and casts columns from `raw__screngn__xcd_bil_account`."
    columns:
      - name: bil_account_id
        description: 'Billing account identifier, likely from `raw__screngn__xcd_bil_account.bil_account_id`.'
        data_type: varchar
      - name: bil_account_id_hash
        description: "Hashed billing account identifier, likely from `raw__screngn__xcd_bil_account.bil_account_id_hash`. See `sha256` hash of `bil_account_id`. Can be used in joins since an integer should be easier to lookup.."
        data_tests:
          - not_null
        data_type: bigint
      - name: BIL_ACCOUNT_NBR
        data_type: bigint
        quote: true
      - name: BIL_CLASS_CD
        data_type: varchar
        quote: true
      - name: BAT_PAY_CLT_ID
        data_type: varchar
        quote: true
      - name: BAT_START_DUE_DT
        data_type: varchar
        quote: true
      - name: BAT_LAST_DAY_IND
        data_type: bigint
        quote: true
      - name: BIL_START_RFR_DT
        data_type: varchar
        quote: true
      - name: BIL_RFR_LST_DAY
        data_type: bigint
        quote: true
      - name: BIL_SUS_FU_REA_CD
        data_type: varchar
        quote: true
      - name: BAT_PREV_BAL_AMT
        data_type: double
        quote: true
      - name: BIL_LOK_TS
        data_type: varchar
        quote: true
      - name: BAT_CASH_STATUS_CD
        data_type: varchar
        quote: true
      - name: BIL_SUS_DSB_REA_CD
        data_type: varchar
        quote: true
      - name: APP_MIGRATION_CD
        data_type: varchar
        quote: true
      - name: BIL_START_DED_DT
        data_type: varchar
        quote: true
      - name: BIL_START_DED_RFR_DT
        data_type: varchar
        quote: true
      - name: BIL_TYPE_CD
        data_type: varchar
        quote: true
      - name: BIL_TYPE_DESC
        data_type: varchar
        quote: true
      - name: BAT_STATUS_CD
        data_type: varchar
        quote: true
      - name: BAT_STATUS_DESC
        data_type: varchar
        quote: true
      - name: BIL_PRESENTMENT_CD
        data_type: varchar
        quote: true
      - name: BIL_PRESENTMENT_DESC
        data_type: varchar
        quote: true
      - name: BIL_COLLECTION_MTH
        data_type: varchar
        quote: true
      - name: BIL_COLLECTION_METHOD_DESC
        data_type: varchar
        quote: true
      - name: BIL_COLLECTION_PLN
        data_type: varchar
        quote: true
      - name: BIL_COLLECTION_PLN_DESC
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_act_summary
    description: "Staging model for billing account summary from the 'screngn' source. Derived from `raw__screngn__xcd_bil_act_summary`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: bil_acy_dt
        data_tests:
          - not_null
        data_type: date
      - name: bil_acy_amt
        data_tests:
          - not_null
        data_type: double
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: BIL_ACY_SEQ
        data_type: bigint
        quote: true
      - name: POL_SYMBOL_CD
        data_type: varchar
        quote: true
      - name: POL_NBR
        data_type: varchar
        quote: true
      - name: BIL_ACY_DES_CD
        data_type: varchar
        quote: true
      - name: BIL_DES_REA_TYP
        data_type: varchar
        quote: true
      - name: BIL_ACY_DES1_DT
        data_type: date
        quote: true
      - name: BIL_ACY_DES2_DT
        data_type: date
        quote: true
      - name: USER_ID
        data_type: varchar
        quote: true
      - name: BIL_ACY_TS
        data_type: varchar
        quote: true
      - name: BAS_ADD_DATA_TXT
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_cash_dsp
    description: "Staging model for billing cash disbursements from the 'screngn' source. Derived from `raw__screngn__xcd_bil_cash_dsp`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: XCD_POLICY_ID # Used to derive billing_policy_key
        data_tests:
          - not_null
        data_type: varchar
      - name: POL_EFFECTIVE_DT
        data_tests:
          - not_null
        data_type: date
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: BIL_DTB_DT
        data_type: date
        quote: true
      - name: BIL_DTB_SEQ_NBR
        data_type: bigint
        quote: true
      - name: BIL_DSP_SEQ_NBR
        data_type: bigint
        quote: true
      - name: BIL_SEQ_NBR
        data_type: bigint
        quote: true
      - name: POL_SYMBOL_CD
        data_type: varchar
        quote: true
      - name: POL_NBR
        data_type: ubigint
        quote: true
      - name: DWS_STATUS_CD
        data_type: varchar
        quote: true
      - name: BIL_REVS_RSUS_IND
        data_type: varchar
        quote: true
      - name: BIL_DSP_REASON_CD
        data_type: varchar
        quote: true
      - name: BIL_DSP_AMT
        data_type: double
        quote: true
      - name: BIL_ADJ_DUE_DT
        data_type: date
        quote: true
      - name: BIL_INV_DT
        data_type: date
        quote: true
      - name: BIL_DSP_DT
        data_type: date
        quote: true
      - name: BIL_DSP_TYPE_CD
        data_type: varchar
        quote: true
      - name: ACTIVITY
        data_type: varchar
        quote: true
      - name: BIL_CRG_TYPE_CD
        data_type: varchar
        quote: true
      - name: PAYMENT_IDENTIFIER
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_cash_receipt
    description: "Staging model for billing cash receipts from the 'screngn' source. Derived from `raw__screngn__xcd_bil_cash_receipt`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: bil_cash_rec_dt
        data_tests:
          - not_null # Core date field
      - name: bil_cash_rec_amt
        data_tests:
          - not_null # Monetary amount
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: BIL_DTB_DT
        data_type: date
        quote: true
      - name: BIL_DTB_SEQ_NBR
        data_type: bigint
        quote: true
      - name: BIL_DEPOSIT_DT
        data_type: date
        quote: true
      - name: BIL_RCT_AMT
        data_type: double
        quote: true
      - name: BIL_RCT_ID
        data_type: varchar
        quote: true
      - name: BIL_RCT_RECEIVE_DT
        data_type: date
        quote: true
      - name: BIL_CSH_ETR_MTH_CD
        data_type: varchar
        quote: true
      - name: BIL_RCT_TYPE_CD
        data_type: varchar
        quote: true
      - name: PAYMENT_TYPE
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_des_reason
    description: "Staging model for billing designation reasons from the 'screngn' source. Derived from `raw__screngn__xcd_bil_des_reason`."
    columns:
      - name: BIL_DES_REA_CD
        data_type: varchar
        quote: true
      - name: BIL_DES_REA_TYP
        data_type: varchar
        quote: true
      - name: PRI_LGG_CD
        data_type: varchar
        quote: true
      - name: BIL_DES_REA_DES
        data_type: varchar
        quote: true
      - name: BDR_LONG_DES
        data_type: varchar
        quote: true
      - name: BIL_ACT_BAL_SUM_CD
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_ist_schedule
    description: "Staging model for billing installment schedules from the 'screngn' source. Derived from `raw__screngn__xcd_bil_ist_schedule`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: bil_ist_eff_dt
        data_tests:
          - not_null # Core date field
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: XCD_POLICY_ID
        data_type: varchar
        quote: true
      - name: BIL_SEQ_NBR
        data_type: bigint
        quote: true
      - name: POL_EFFECTIVE_DT
        data_type: date
        quote: true
      - name: BIL_INV_DT
        data_type: date
        quote: true
      - name: BIL_ADJ_DUE_DT
        data_type: date
        quote: true
      - name: BIL_REFERENCE_DT
        data_type: date
        quote: true
      - name: BIL_PRM_IST_AMT
        data_type: double
        quote: true
      - name: BIS_CRE_FUT_AMT
        data_type: double
        quote: true
      - name: BIS_CNC_FUT_AMT
        data_type: double
        quote: true
      - name: BIS_CRE_OPN_AMT
        data_type: double
        quote: true
      - name: BIS_CNC_OPN_AMT
        data_type: double
        quote: true
      - name: BIS_PRM_PAID_AMT
        data_type: double
        quote: true
      - name: BIS_WRO_PRM_AMT
        data_type: double
        quote: true
      - name: BIS_CRE_PAID_AMT
        data_type: double
        quote: true
      - name: BIL_INVOICE_CD
        data_type: varchar
        quote: true
      - name: INVOICED
        data_type: boolean
        quote: true
      - name: BIS_NON_TRM_DT_IND
        data_type: varchar
        quote: true
      - name: INVOICE_TYPE
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_pol_proc_req
    description: "Staging model for billing policy processing requests from the 'screngn' source. Derived from `raw__screngn__xcd_bil_pol_proc_req`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: BIL_REQUEST_TYP
        data_type: varchar
        quote: true
      - name: BIL_ACY_TS
        data_type: varchar
        quote: true
      - name: XCD_POLICY_ID
        data_type: varchar
        quote: true
      - name: POL_EFFECTIVE_DT
        data_type: date
        quote: true
      - name: BIL_CONTEXT
        data_type: varchar
        quote: true
      - name: BIL_ACT_DT
        data_type: date
        quote: true
      - name: BIL_PROCESS_CD
        data_type: varchar
        quote: true
      - name: BIL_LST_MDF_TS
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_policy_trm
    description: "Staging model for billing policy terms from the 'screngn' source. Derived from `raw__screngn__xcd_bil_policy_trm`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: XCD_POLICY_ID
        data_tests:
          - not_null
        data_type: varchar
      - name: POL_EFFECTIVE_DT
        data_tests:
          - not_null
        data_type: date
      - name: BPT_STATUS_EFF_DT
        data_tests:
          - not_null
        data_type: date
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: MASTER_COMPANY_NBR
        data_type: varchar
        quote: true
      - name: PLN_EXP_DT
        data_type: date
        quote: true
      - name: BPT_ISU_CLT_ID
        data_type: varchar
        quote: true
      - name: BPT_ISU_ADR_SEQ
        data_type: bigint
        quote: true
      - name: BPT_AGT_CLT_ID
        data_type: varchar
        quote: true
      - name: BPT_AGT_ADR_SEQ
        data_type: bigint
        quote: true
      - name: LOB_CD
        data_type: varchar
        quote: true
      - name: BIL_STATE_PVN_CD
        data_type: varchar
        quote: true
      - name: BIL_COUNTRY_CD
        data_type: varchar
        quote: true
      - name: BPT_WRO_PRC_IND
        data_type: varchar
        quote: true
      - name: BIL_SUS_FU_REA_CD
        data_type: varchar
        quote: true
      - name: BPT_AGREEMENT_IND
        data_type: varchar
        quote: true
      - name: BPT_ISSUE_SYS_ID
        data_type: varchar
        quote: true
      - name: BIL_TO_FRO_TRF_NBR
        data_type: bigint
        quote: true
      - name: BPT_AUDIT_CD
        data_type: varchar
        quote: true
      - name: BPT_TERM_SPLIT_IND
        data_type: varchar
        quote: true
      - name: BPT_BELOW_MIN_CNT
        data_type: bigint
        quote: true
      - name: BPT_POL_UW_STA_CD
        data_type: varchar
        quote: true
      - name: BPT_UW_STA_EFF_DT
        data_type: date
        quote: true
      - name: BPT_POL_COL_AMT
        data_type: double
        quote: true
      - name: BPT_ACT_COL_CD
        data_type: varchar
        quote: true
      - name: CFC_SVC_CD
        data_type: varchar
        quote: true
      - name: BIL_PLAN_CD
        data_type: varchar
        quote: true
      - name: TERM_BILLING_PLAN
        data_type: varchar
        quote: true
      - name: BIL_POL_STATUS_CD
        data_type: varchar
        quote: true
      - name: BILLING_POLICY_STATUS
        data_type: varchar
        quote: true

  - name: stg__screngn__xcd_bil_policy
    description: "Staging model for billing policies from the 'screngn' source. Derived from `raw__screngn__xcd_bil_policy`."
    columns:
      - name: bil_account_id_hash
        data_tests:
          - not_null
        data_type: bigint
      - name: XCD_POLICY_ID
        data_tests:
          - not_null
        data_type: varchar
      - name: pol_eff_dt # Assuming this is policy effective date
        data_tests:
          - not_null # Core date field
      - name: BIL_ACCOUNT_ID
        data_type: varchar
        quote: true
      - name: POL_SYMBOL_CD
        data_type: varchar
        quote: true
      - name: POL_NBR
        data_type: ubigint
        quote: true
      - name: BIL_ACCOUNT_NBR
        data_type: bigint
        quote: true
      - name: CUR_BIL_PLAN_CD
        data_type: varchar
        quote: true
      - name: CURRENT_BILLING_PLAN
        data_type: varchar
        quote: true
      - name: BIL_ISSUE_IND
        data_type: varchar
        quote: true
      - name: BIL_POLICY_ISSUE_IND_DESC
        data_type: varchar
        quote: true
