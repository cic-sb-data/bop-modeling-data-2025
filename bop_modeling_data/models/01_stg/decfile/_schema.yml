models:
  - name: stg__decfile__sb_policy_lookup
    description: "Staging model for small business policy lookup data from the 'decfile' source. It likely performs basic cleaning, renaming, and type casting on `raw__decfile__sb_policy_lookup`."
    data_tests:
      - dbt_expectations.expect_table_row_count_to_equal_other_table:
          compare_model: ref("raw__decfile__sb_policy_lookup")
    columns:
      - name: sb_policy_key
        description: 'Unique integer key for each policy five-key and line of business (e.g., prop or liab) combination.'
        data_tests:
          - dbt_expectations.expect_column_values_to_be_unique
          - dbt_expectations.expect_column_values_to_not_be_null
      - name: policy_chain_id
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
      - name: lob
        description: 'Line of business. Must be one of ["prop", "liab"].'
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: ['prop', 'liab']
      - name: company_numb
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: [1, 3, 5, 7, 4]
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 9

      - name: policy_sym
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
      - name: policy_numb
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 9999999 # 7-digit number
      - name: policy_module
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 999 # 3-digit number
      - name: policy_eff_date
        data_tests:
          - dbt_expectations.expect_column_values_to_not_be_null
